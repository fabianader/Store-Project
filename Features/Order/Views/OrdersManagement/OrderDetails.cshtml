@using StoreProject.Common
@using StoreProject.Features.Order.DTOs
@using StoreProject.Features.Order.Models;
@model OrderDetailsModel
@{
    Layout = "_AdminLayout";
    ViewData["selected"] = "orders";
    ViewData["Title"] = "Orders Management";
    ViewData["ActionName"] = "Order Details";

    List<string> BootstrapColors = ["dark", "info", "primary", "success", "danger"];
}

<div class="card card-info">

    <form asp-controller="OrdersManagement" asp-action="OrderDetails" asp-antiforgery="true" method="post">
        <div asp-validation-summary="ModelOnly" class="text-danger"></div>
        <div class="card-body">

            <input type="hidden" asp-for="Id"/>
            <input type="hidden" asp-for="UserId"/>
            <input type="hidden" asp-for="UserName"/>
            <input type="hidden" asp-for="OrderDate"/>
            <input type="hidden" asp-for="TotalPrice"/>
            <input type="hidden" asp-for="OrderItems"/>

            <h2>Order Details</h2>
            <div>
                <p><strong>Order Id: </strong>@Model.Id</p>
                <p><strong>User Id: </strong>@Model.UserId</p>
                <p><strong>User Name: </strong>@Model.UserName</p>
                <p><strong>Order Date: </strong>@Model.OrderDate.ToShortDateString()</p>
                <p><strong>Total: </strong>$@Model.TotalPrice</p>
            </div>

            <br />

            <h3>Items:</h3>
            <div class="card-body table-responsive p-0">
                <table class="table table-hover text-nowrap">
                    <thead>
                        <tr>
                            <th>Product</th>
                            <th>Quantity</th>
                            <th>Unit Price</th>
                            <th>Product Total</th>
                        </tr>
                    </thead>

                    <tbody>
                        @foreach (var item in Model.OrderItems)
                        {
                            <tr>
                                <td>@item.ProductTitle</td>
                                <td>@item.Quantity</td>
                                <td>@item.UnitPrice</td>
                                <td>$@(item.Quantity * item.UnitPrice)</td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
            
            <br />
            
            <h3>Admin Controls</h3>
            <div class="row">
                <div class="form-group col-md-6">
                    <label asp-for="FullName"></label>
                    <input type="text" class="form-control" asp-for="FullName">
                    <span asp-validation-for="FullName" class="text-danger"></span>
                </div>

                <div class="form-group col-md-6">
                    <label asp-for="Email"></label>
                    <input type="text" class="form-control" asp-for="Email">
                    <span asp-validation-for="Email" class="text-danger"></span>
                </div>
            </div>

            <div class="row">
                <div class="form-group col-md-6">
                    <label asp-for="PhoneNumber"></label>
                    <input class="form-control" asp-for="PhoneNumber">
                    <span asp-validation-for="PhoneNumber" class="text-danger"></span>
                </div>

                <div class="form-group col-md-6">
                    <label asp-for="Status"></label>
                    <select asp-for="Status" class="form-control">Choose:>
                        <option value="null" class="text-secondary">Select</option>
                        @for(int i = 0; i < Enum.GetNames(typeof(OrderStatusDto)).Length; i++)
                        {
                            <option value=@(i) class="text-@CommonService.GetOrderStatusBootstrapColor(i)">
                                @((OrderStatusDto)i)
                            </option>
                        }
                        
                    </select>
                    <span asp-validation-for="Status" class="text-danger"></span>
                </div>
            </div>

            <div class="form-group col-md-6">
                <label asp-for="Address"></label>
                <textarea type="text" class="form-control" asp-for="Address"></textarea>
                <span asp-validation-for="Address" class="text-danger"></span>
            </div><br />

            <center>
                <div class="form-group">
                    <button type="submit" class="btn btn-primary">Edit Order</button>
                </div>
            </center>
    </form>        
</div>


